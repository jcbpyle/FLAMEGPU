<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="FLAMEGPU_vcproj.xslt"?>

<exp:Experimentation xmlns:exp="https://jcbpyle.github.io/XMMLExperiment" xmlns:gpu="http://www.dcs.shef.ac.uk/~paul/XMMLGPU" xmlns="http://www.dcs.shef.ac.uk/~paul/XMML">
    <exp:Imports>
        <exp:Import>
            <exp:Module>os</exp:Module>
        </exp:Import>
        <exp:Import>
            <exp:Module>threading</exp:Module>
        </exp:Import>
        <exp:Import>
            <exp:Module>sys</exp:Module>
        </exp:Import>
        <exp:Import>
            <exp:Module>queue</exp:Module>
        </exp:Import>
        <exp:Import>
            <exp:Module>random</exp:Module>
        </exp:Import>
        <exp:Import>
            <exp:Module>datetime</exp:Module>
        </exp:Import>
    </exp:Imports>

    <exp:InitialStates>
        <exp:InitialState>
            <exp:ConfigurationName>predprey</exp:ConfigurationName>
            <exp:Location>/iterations</exp:Location>
            <exp:FileName>0</exp:FileName>
            <exp:Globals>
                <exp:global>
                    <exp:name>INTERACTION_DISTANCE_TEST_VARIABLE</exp:name>
                    <exp:value>
                        <exp:fixed_value>0.12345</exp:fixed_value>
                    </exp:value>
                    <exp:type>float</exp:type>
                </exp:global>
                <exp:global>
                    <exp:name>REPRODUCE_PREY_PROB</exp:name>
                    <exp:value>
                        <exp:range>
                            <exp:min>0</exp:min>
                            <exp:max>0.25</exp:max>
                        </exp:range>
                        <exp:type>float</exp:type>
                    </exp:value>
                </exp:global>
                <exp:global>
                    <exp:name>REPRODUCE_PREDATOR_PROB</exp:name>
                    <exp:value>
                        <exp:range>
                            <exp:min>0</exp:min>
                            <exp:max>0.25</exp:max>
                        </exp:range>
                        <exp:type>float</exp:type>
                    </exp:value>
                </exp:global>
                <exp:global>
                    <exp:name>GAIN_FROM_FOOD_PREY</exp:name>
                    <exp:value>
                        <exp:range>
                            <exp:min>0</exp:min>
                            <exp:max>500</exp:max>
                        </exp:range>
                        <exp:type>int</exp:type>
                    </exp:value>
                </exp:global>
                <exp:global>
                    <exp:name>GAIN_FROM_FOOD_PREDATOR</exp:name>
                    <exp:value>
                        <exp:range>
                            <exp:min>0</exp:min>
                            <exp:max>500</exp:max>
                        </exp:range>
                        <exp:type>int</exp:type>
                    </exp:value>
                </exp:global>
                <exp:global>
                    <exp:name>GRASS_REGROW_CYCLES</exp:name>
                    <exp:value>
                        <exp:range>
                            <exp:min>0</exp:min>
                            <exp:max>500</exp:max>
                        </exp:range>
                        <exp:type>int</exp:type>
                    </exp:value>
                </exp:global>
            </exp:Globals>
            <exp:Populations>
                <exp:population>
                    <exp:agent>prey</exp:agent>                                 
                    <exp:state>default1</exp:state>
                    <exp:InitialPopulationCount>
                        <exp:range>
                            <exp:min>0</exp:min>
                            <exp:max>5000</exp:max>
                        </exp:range>
                    </exp:InitialPopulationCount>                                   
                    <exp:Variables>                                         
                        <exp:variable>
                            <exp:name>x</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>y</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>type</exp:name>
                            <exp:value>
                                <exp:fixed_value>1</exp:fixed_value>
                            </exp:value>
                            <exp:type>float</exp:type>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>fx</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>fy</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>steer_x</exp:name>
                            <exp:value>
                                <exp:fixed_value>0.0</exp:fixed_value>
                            </exp:value>
                            <exp:type>float</exp:type>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>steer_y</exp:name>
                            <exp:value>
                                <exp:fixed_value>0.0</exp:fixed_value>
                            </exp:value>
                            <exp:type>float</exp:type>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>life</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>1</exp:min>
                                    <exp:max>50</exp:max>
                                </exp:range>
                                <exp:type>int</exp:type>
                            </exp:value>
                            <exp:type>int</exp:type>
                        </exp:variable>
                    </exp:Variables>
                </exp:population>
                <exp:population>
                    <exp:agent>predator</exp:agent>                                 
                    <exp:state>default2</exp:state>
                    <exp:InitialPopulationCount>
                        <exp:range>
                            <exp:min>0</exp:min>
                            <exp:max>5000</exp:max>
                        </exp:range>
                    </exp:InitialPopulationCount>                                   
                    <exp:Variables>                                         
                        <exp:variable>
                            <exp:name>x</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>y</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>type</exp:name>
                            <exp:value>
                                <exp:fixed_value>1</exp:fixed_value>
                            </exp:value>
                            <exp:type>float</exp:type>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>fx</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>fy</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>steer_x</exp:name>
                            <exp:value>
                                <exp:fixed_value>0.0</exp:fixed_value>
                            </exp:value>
                            <exp:type>float</exp:type>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>steer_y</exp:name>
                            <exp:value>
                                <exp:fixed_value>0.0</exp:fixed_value>
                            </exp:value>
                            <exp:type>float</exp:type>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>life</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>1</exp:min>
                                    <exp:max>50</exp:max>
                                </exp:range>
                                <exp:type>int</exp:type>
                            </exp:value>
                            <exp:type>int</exp:type>
                        </exp:variable>
                    </exp:Variables>
                </exp:population>
                <exp:population>
                    <exp:agent>grass</exp:agent>                                 
                    <exp:state>default3</exp:state>
                    <exp:InitialPopulationCount>
                        <exp:range>
                            <exp:min>0</exp:min>
                            <exp:max>5000</exp:max>
                        </exp:range>
                    </exp:InitialPopulationCount>                                   
                    <exp:Variables>                                         
                        <exp:variable>
                            <exp:name>x</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>y</exp:name>
                            <exp:value>
                                <exp:range>
                                    <exp:min>-1.0</exp:min>
                                    <exp:max>1.0</exp:max>
                                </exp:range>
                                <exp:type>float</exp:type>
                            </exp:value>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>type</exp:name>
                            <exp:value>
                                <exp:fixed_value>2</exp:fixed_value>
                            </exp:value>
                            <exp:type>float</exp:type>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>dead_cycles</exp:name>
                            <exp:value>
                                <exp:fixed_value>0</exp:fixed_value>
                            </exp:value>
                            <exp:type>int</exp:type>
                        </exp:variable>
                        <exp:variable>
                            <exp:name>available</exp:name>
                            <exp:value>
                                <exp:fixed_value>1</exp:fixed_value>
                            </exp:value>
                            <exp:type>int</exp:type>
                        </exp:variable>
                    </exp:Variables>
                </exp:population>                    
            </exp:Populations>
        </exp:InitialState>
    </exp:InitialStates>

    <exp:ExperimentSet>
        <exp:Experiment>
            <exp:ExperimentName>testing_initial_state</exp:ExperimentName>
            <exp:Model>
                <exp:ExecutableLocation>../../../bin/x64/Release_Console/</exp:ExecutableLocation>
                <exp:ModelName>PreyPredator_api_test</exp:ModelName>
            </exp:Model>
            <exp:InitialState>
                <exp:Generator>predprey</exp:Generator>
                <exp:Location>/iterations</exp:Location>
                <exp:SimulationOutputLocation>/iterations</exp:SimulationOutputLocation>
            </exp:InitialState>
        </exp:Experiment>


        <exp:Experiment>
            <exp:ExperimentName>testing_batch_simulation</exp:ExperimentName>
            <exp:Model>
                <exp:ExecutableLocation>../../../bin/x64/Release_Console/</exp:ExecutableLocation>
                <exp:ModelName>PreyPredator_api_test</exp:ModelName>
            </exp:Model>
            <exp:InitialState>
                <exp:Generator>predprey</exp:Generator>
                <exp:Location>/iterations</exp:Location>
                <exp:SimulationOutputLocation>/iterations</exp:SimulationOutputLocation>
            </exp:InitialState>
            <exp:Configuration>
                <exp:Iterations>1000</exp:Iterations>
                <exp:Repeats>10</exp:Repeats>
            </exp:Configuration>
        </exp:Experiment>


        <exp:Experiment>
            <exp:ExperimentName>testing_ga_experiment</exp:ExperimentName>
            <exp:Model>
                <exp:ExecutableLocation>../../../bin/x64/Release_Console/</exp:ExecutableLocation>
                <exp:ModelName>PreyPredator_api_test</exp:ModelName>
            </exp:Model>
            <exp:InitialState>
                <exp:Generator>predprey</exp:Generator>
                <exp:Location>/iterations</exp:Location>
                <exp:SimulationOutputLocation>/iterations</exp:SimulationOutputLocation>
            </exp:InitialState>
            <exp:Configuration>
                <exp:ExperimentVariables>
                    <exp:Variable>
                        <exp:Name>mu</exp:Name>
                        <exp:Type>int</exp:Type>
                        <exp:Value>100</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>LAMBDA</exp:Name>
                        <exp:Type>int</exp:Type>
                        <exp:Value>10</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>max_time</exp:Name>
                        <exp:Type>int</exp:Type>
                        <exp:Value>60</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>max_generations</exp:Name>
                        <exp:Type>int</exp:Type>
                        <exp:Value>10</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>mutation</exp:Name>
                        <exp:Type>float</exp:Type>
                        <exp:Value>0.25</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>crossover</exp:Name>
                        <exp:Type>float</exp:Type>
                        <exp:Value>0.5</exp:Value>
                    </exp:Variable>
                </exp:ExperimentVariables>
                <exp:ExperimentFunctions>
                    <exp:Function>
                        <exp:Name>fitness_function</exp:Name>
                        <exp:Arguments>
                            <exp:Argument>primary</exp:Argument>
                            <exp:Argument>secondary</exp:Argument>
                            <exp:Argument>tertiary</exp:Argument>
                        </exp:Arguments>
                        <exp:Returns>
                            <exp:Return>fitness</exp:Return>
                        </exp:Returns>
                    </exp:Function>
                    <exp:Function>
                        <exp:Name>run_ga</exp:Name>
                        <exp:Arguments>
                            <exp:Argument>mu</exp:Argument>
                            <exp:Argument>lamb</exp:Argument>
                            <exp:Argument>gen</exp:Argument>
                            <exp:Argument>time</exp:Argument>
                            <exp:Argument>start</exp:Argument>
                            <exp:Argument>evals</exp:Argument>
                        </exp:Arguments>
                        <exp:GlobalVariables>
                            <exp:Global>curr_pop</exp:Global>
                        </exp:GlobalVariables>
                        <exp:Returns>
                            <exp:Return>population</exp:Return>
                        </exp:Returns>
                    </exp:Function>
                </exp:ExperimentFunctions>
                <exp:Iterations>1000</exp:Iterations>
                <exp:Repeats>1</exp:Repeats>
            </exp:Configuration>
        </exp:Experiment>

        <exp:Experiment>
            <exp:ExperimentName>testing_surrogate_experiment</exp:ExperimentName>
            <exp:Model>
                <exp:ExecutableLocation>../../../bin/x64/Release_Console/</exp:ExecutableLocation>
                <exp:ModelName>PreyPredator_api_test</exp:ModelName>
            </exp:Model>
            <exp:InitialStateGenerator>predprey</exp:InitialStateGenerator>
            <exp:Configuration>
                <exp:ExperimentVariables>
                    <exp:Variable>
                        <exp:Name>hidden_layers</exp:Name>
                        <exp:Type>tuple</exp:Type>
                        <exp:Value>100,100</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>error</exp:Name>
                        <exp:Type>float</exp:Type>
                        <exp:Value>1e-9</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>max_time</exp:Name>
                        <exp:Type>int</exp:Type>
                        <exp:Value>60</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>max_training_generations</exp:Name>
                        <exp:Type>int</exp:Type>
                        <exp:Value>2000</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>mutation</exp:Name>
                        <exp:Type>float</exp:Type>
                        <exp:Value>0.25</exp:Value>
                    </exp:Variable>
                    <exp:Variable>
                        <exp:Name>crossover</exp:Name>
                        <exp:Type>float</exp:Type>
                        <exp:Value>0.5</exp:Value>
                    </exp:Variable>
                </exp:ExperimentVariables>
                <exp:ExperimentFunctions>
                    <exp:Function>
                        <exp:Name>fitness_function</exp:Name>
                        <exp:Arguments>
                            <exp:Argument>primary</exp:Argument>
                            <exp:Argument>secondary</exp:Argument>
                            <exp:Argument>tertiary</exp:Argument>
                        </exp:Arguments>
                        <exp:Returns>
                            <exp:Return>fitness</exp:Return>
                        </exp:Returns>
                    </exp:Function>
                </exp:ExperimentFunctions>
                <exp:Iterations>1000</exp:Iterations>
                <exp:Repeats>1</exp:Repeats>
            </exp:Configuration>
        </exp:Experiment>
    </exp:ExperimentSet>




    <exp:Logging>
        <exp:Log>
            <exp:InitLog>
                <exp:name>log_all_pred_life</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>pls</exp:identifier> 
                <exp:LogAgentVariable>
                    <exp:agent>pred</exp:agent>
                    <exp:state>default2</exp:state>
                    <exp:variable>life</exp:variable>
                    <exp:variable_type>float</exp:variable_type>
                </exp:LogAgentVariable> 
            </exp:InitLog>            
        </exp:Log>
        <exp:Log>
            <exp:ExitLog>
                <exp:name>log_all_final_pred_life</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>ple</exp:identifier> 
                <exp:LogAgentVariable>
                    <exp:agent>pred</exp:agent>
                    <exp:state>default2</exp:state>
                    <exp:variable>life</exp:variable>
                    <exp:variable_type>float</exp:variable_type>
                </exp:LogAgentVariable> 
            </exp:ExitLog>            
        </exp:Log>
        <exp:Log>
            <exp:InitLog>
                <exp:name>global_log_prey</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>num_prey</exp:identifier> 
                <exp:LogAgentTypeCount>
                    <exp:agent>prey</exp:agent>
                    <exp:state>default1</exp:state>
                </exp:LogAgentTypeCount> 
            </exp:InitLog>            
        </exp:Log>
        <exp:Log>
            <exp:InitLog>
                <exp:name>global_log_predator</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>num_pred</exp:identifier> 
                <exp:LogAgentTypeCount>
                    <exp:agent>predator</exp:agent>
                    <exp:state>default2</exp:state>
                </exp:LogAgentTypeCount> 
            </exp:InitLog>            
        </exp:Log>
        <exp:Log>
            <exp:InitLog>
                <exp:name>global_log_grass</exp:name>
                <exp:identifier>num_grass</exp:identifier> 
                <exp:file>log.csv</exp:file> 
                <exp:LogAgentTypeCount>
                    <exp:agent>grass</exp:agent>
                    <exp:state>default3</exp:state>
                </exp:LogAgentTypeCount> 
            </exp:InitLog>            
        </exp:Log>
        <exp:Log>
            <exp:InitLog>
                <exp:name>global_log_prey_reproduction</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>prey_reproduction</exp:identifier> 
                <exp:LogGlobal>
                    <exp:variable_type>float</exp:variable_type>
                    <exp:global>REPRODUCE_PREY_PROB</exp:global>
                </exp:LogGlobal> 
            </exp:InitLog>            
        </exp:Log>
        <exp:Log>
            <exp:InitLog>
                <exp:name>global_log_pred_reproduction</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>pred_reproduction</exp:identifier> 
                <exp:LogGlobal>
                    <exp:variable_type>float</exp:variable_type>
                    <exp:global>REPRODUCE_PREDATOR_PROB</exp:global>
                </exp:LogGlobal> 
            </exp:InitLog>          
        </exp:Log>
        <exp:Log>
            <exp:InitLog>
                <exp:name>global_log_prey_energy_gain</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>prey_energy</exp:identifier> 
                <exp:LogGlobal>
                    <exp:variable_type>int</exp:variable_type>
                    <exp:global>GAIN_FROM_FOOD_PREY</exp:global>
                </exp:LogGlobal> 
            </exp:InitLog>          
        </exp:Log>
        <exp:Log>
            <exp:InitLog>
                <exp:name>global_log_pred_energy_gain</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>pred_energy</exp:identifier> 
                <exp:LogGlobal>
                    <exp:variable_type>int</exp:variable_type>
                    <exp:global>GAIN_FROM_FOOD_PREDATOR</exp:global>
                </exp:LogGlobal> 
            </exp:InitLog>           
        </exp:Log>
        <exp:Log>
            <exp:InitLog>
                <exp:name>global_log_grass_regrowth</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>grass_regrowth</exp:identifier> 
                <exp:LogGlobal>
                    <exp:variable_type>int</exp:variable_type>
                    <exp:global>GRASS_REGROW_CYCLES</exp:global>
                </exp:LogGlobal> 
            </exp:InitLog>             
        </exp:Log>
        <exp:Log>
            <exp:ExitLog>
                <exp:name>primary_fitness_output</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>primary_fitness</exp:identifier> 
                <exp:LogFunction>
                    <exp:function>calculate_primary_fitness</exp:function>
                    <exp:return_type>int</exp:return_type>
                </exp:LogFunction> 
            </exp:ExitLog>             
        </exp:Log>
        <exp:Log>
            <exp:ExitLog>
                <exp:name>secondary_fitness_output</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>secondary_fitness</exp:identifier> 
                <exp:LogFunction>
                    <exp:function>calculate_secondary_fitness</exp:function>
                    <exp:return_type>float</exp:return_type>
                </exp:LogFunction> 
            </exp:ExitLog>             
        </exp:Log>
        <exp:Log>
            <exp:ExitLog>
                <exp:name>tertiary_fitness_output</exp:name>
                <exp:file>log.csv</exp:file> 
                <exp:identifier>tertiary_fitness</exp:identifier> 
                <exp:LogFunction>
                    <exp:function>calculate_tertiary_fitness</exp:function>
                    <exp:return_type>float</exp:return_type>
                </exp:LogFunction> 
            </exp:ExitLog>             
        </exp:Log>
    </exp:Logging>
</exp:Experimentation>